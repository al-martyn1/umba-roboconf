Для каждого документа нам нужно выбрать максимально короткое, но уникальное имя.
Кандидаты - длинная "маска", где перечислены все версии STMки, и короткая маска, где только указан range

Оки. Делаем map set'ов, где ключ - маска STMки, а set - имена конкретных файлов.

Для каждого сета имен STMок генерим две маски имени. Каждая из этих масок работает ключем.
По этому ключу есть set, где содержатся конкретные имена файлов.

Далее - есть set имен STMок, генерим две версии маски.
Сортируем их по длине: короткая - раньше
Если находим, и соответствует единственный документ, то выбираем эту версию маски.
Инвче - выбираем длинную
